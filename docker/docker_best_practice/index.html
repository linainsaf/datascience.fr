
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://datascience_careerera.fr/docker/docker_best_practice/">
      
      
        <link rel="prev" href="../docker_https/">
      
      
        <link rel="next" href="../../sql/02_db_kesako/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.6">
    
    
      
        <title>Best Practices - Data Science</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.558e4712.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.2505c338.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#best-practices" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Data Science" class="md-header__button md-logo" aria-label="Data Science" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Data Science
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Best Practices
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Data Science" class="md-nav__button md-logo" aria-label="Data Science" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Data Science
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Introduction à la Data Science
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2" tabindex="0" aria-expanded="false">
          Apprentissage automatique (a.k.a Machine Learning)
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Apprentissage automatique (a.k.a Machine Learning)" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Apprentissage automatique (a.k.a Machine Learning)
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ml/" class="md-nav__link">
        Les taches et modéles de ML
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../eval/" class="md-nav__link">
        Evaluation des modéles de Classification et de Regression
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" tabindex="0" aria-expanded="false">
          Le Deep Learning
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Le Deep Learning" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Le Deep Learning
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../dl/" class="md-nav__link">
        Introduction au Deep Learning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../dltypes/" class="md-nav__link">
        Les différents types de réseaux de neurones
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../api/" class="md-nav__link">
        API (Application Programmable Interface)
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      
      
        <label class="md-nav__link" for="__nav_5" tabindex="0" aria-expanded="true">
          Docker for App Deployment
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Docker for App Deployment" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Docker for App Deployment
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../docker_intro/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../docker_install/" class="md-nav__link">
        Setting up Docker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../docker_python_app/" class="md-nav__link">
        Building a Docker Image for Python App
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../docker_commands/" class="md-nav__link">
        Docker CLI Commands
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../docker_volume/" class="md-nav__link">
        Docker Volumes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sql/06_b_docker_install/" class="md-nav__link">
        Install MySQL with docker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sql/29_python_docker_sql.md" class="md-nav__link">
        SQLAlchemy and Docker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../docker_network/" class="md-nav__link">
        Docker Network
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../docker_compose/" class="md-nav__link">
        Docker-compose
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../docker_https/" class="md-nav__link">
        Docker and HTTPS
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Best Practices
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Best Practices
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#best-practices-for-design-and-optimize-containers" class="md-nav__link">
    Best Practices for design and optimize containers
  </a>
  
    <nav class="md-nav" aria-label="Best Practices for design and optimize containers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#use-an-appropriate-base-image" class="md-nav__link">
    Use an appropriate base image
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#avoid-running-as-root" class="md-nav__link">
    Avoid running as root
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#keep-layers-small" class="md-nav__link">
    Keep layers small
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-multi-stage-builds" class="md-nav__link">
    Use multi-stage builds
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-caching-to-speed-up-builds" class="md-nav__link">
    Use caching to speed up builds
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clean-up-after-yourself" class="md-nav__link">
    Clean up after yourself
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#consider-security" class="md-nav__link">
    Consider security
  </a>
  
    <nav class="md-nav" aria-label="Consider security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quick-scan-a-container" class="md-nav__link">
    Quick scan a container
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#debugging-and-troubleshooting" class="md-nav__link">
    Debugging and Troubleshooting
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
        <label class="md-nav__link" for="__nav_6" tabindex="0" aria-expanded="false">
          SQL
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="SQL" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          SQL
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_6_1" type="checkbox" id="__nav_6_1" >
      
      
      
        <label class="md-nav__link" for="__nav_6_1" tabindex="0" aria-expanded="false">
          Introduction
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Introduction" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_1">
          <span class="md-nav__icon md-icon"></span>
          Introduction
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sql/02_db_kesako/" class="md-nav__link">
        What is a Database
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sql/03_table/" class="md-nav__link">
        Tables & Keys
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sql/04_basics/" class="md-nav__link">
        SQL Basic understanding
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_6_2" type="checkbox" id="__nav_6_2" >
      
      
      
        <label class="md-nav__link" for="__nav_6_2" tabindex="0" aria-expanded="false">
          Installation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Installation" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_2">
          <span class="md-nav__icon md-icon"></span>
          Installation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sql/05_MacOS_install/" class="md-nav__link">
        Install MySQL on MacOS
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_6_3" type="checkbox" id="__nav_6_3" >
      
      
      
        <label class="md-nav__link" for="__nav_6_3" tabindex="0" aria-expanded="false">
          CRUD (Create, Read, Update, Delete) operations
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="CRUD (Create, Read, Update, Delete) operations" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_3">
          <span class="md-nav__icon md-icon"></span>
          CRUD (Create, Read, Update, Delete) operations
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sql/07_creating_tables/" class="md-nav__link">
        Creating tables
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sql/08_insert/" class="md-nav__link">
        Inserting Data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sql/09_constraints/" class="md-nav__link">
        Constraints
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sql/10_update_delete/" class="md-nav__link">
        Update & Delete
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sql/11_queries/" class="md-nav__link">
        Basic Queries
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sql/12_company_db_1/" class="md-nav__link">
        Build a company database from scratch
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sql/13_queries_db/" class="md-nav__link">
        More Queries
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sql/14_functions/" class="md-nav__link">
        SQL Functions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sql/15_Wildcards/" class="md-nav__link">
        Wildcards & Unions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sql/17_joins/" class="md-nav__link">
        Joins
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sql/18_Nested_Queries/" class="md-nav__link">
        Nested Queries
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sql/19_delete/" class="md-nav__link">
        On Delete
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sql/20_triggers/" class="md-nav__link">
        Triggers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sql/21_er_diagrams/" class="md-nav__link">
        ER DIagrams
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#best-practices-for-design-and-optimize-containers" class="md-nav__link">
    Best Practices for design and optimize containers
  </a>
  
    <nav class="md-nav" aria-label="Best Practices for design and optimize containers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#use-an-appropriate-base-image" class="md-nav__link">
    Use an appropriate base image
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#avoid-running-as-root" class="md-nav__link">
    Avoid running as root
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#keep-layers-small" class="md-nav__link">
    Keep layers small
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-multi-stage-builds" class="md-nav__link">
    Use multi-stage builds
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-caching-to-speed-up-builds" class="md-nav__link">
    Use caching to speed up builds
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clean-up-after-yourself" class="md-nav__link">
    Clean up after yourself
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#consider-security" class="md-nav__link">
    Consider security
  </a>
  
    <nav class="md-nav" aria-label="Consider security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quick-scan-a-container" class="md-nav__link">
    Quick scan a container
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#debugging-and-troubleshooting" class="md-nav__link">
    Debugging and Troubleshooting
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="best-practices">Best Practices</h1>
<h2 id="best-practices-for-design-and-optimize-containers">Best Practices for design and optimize containers</h2>
<h3 id="use-an-appropriate-base-image">Use an appropriate base image</h3>
<p>The base image you choose can greatly affect the size and security of your final image. Choose a minimal base image and only include what you need to minimize the attack surface and reduce the image size.</p>
<p><br /></p>
<p>One popular base image is <code>Alpine</code> Linux. Alpine Linux is a lightweight Linux distribution that is designed to be small and efficient. It is commonly used for Docker images because of its small size, which makes it ideal for running containers with limited resources.</p>
<p><br /></p>
<p>Another base image that is commonly used is the <code>slim</code> version of the official images provided by different software vendors. For example, the official Python image has a slim version, which is a smaller image with only the necessary dependencies required to run Python applications. This means that you can reduce the size of your Docker image by using the slim version instead of the full version.</p>
<p><br /></p>
<p><em>However, it is important to keep in mind that using a base image that is too small can sometimes cause issues.</em></p>
<h3 id="avoid-running-as-root">Avoid running as root</h3>
<p>Running containers as the root user is considered bad practice because it poses a security risk. By default, the root user inside a container has the same privileges as the root user on the host machine. This means that if an attacker gains control of a container running as root, they could potentially escalate their privileges to the host machine.</p>
<p><br /></p>
<p>To avoid running containers as root, you can specify a non-root user in your Dockerfile using the <code>USER</code> instruction. For example:</p>
<pre><code class="language-dockerfile">FROM python:3.9-slim

# Create a non-root user
RUN useradd --create-home myuser
WORKDIR /home/myuser

# Switch to the non-root user
USER myuser

# Copy application files and install dependencies
COPY requirements.txt .
RUN pip install -r requirements.txt

# Copy the rest of the application code
COPY . .

# Run the application
CMD [&quot;python&quot;, &quot;app.py&quot;]
</code></pre>
<p>In this example, we create a non-root user called myuser and switch to that user using the USER instruction. This user is then used to run the application inside the container.</p>
<h3 id="keep-layers-small">Keep layers small</h3>
<p>When building a Docker image, each line in the Dockerfile creates a new layer in the final image. Layers are stacked on top of each other to create the final image. Each layer only stores the changes made on top of the previous layer, which results in a more efficient use of disk space and a faster build time.</p>
<p><br /></p>
<p>Keeping layers small is important because it can make it easier to update or modify specific parts of the image without rebuilding the entire image. This can be especially important when dealing with large applications that have many dependencies.</p>
<p><br /></p>
<p><img alt="Screenshot" src="https://sachcode.com/static/3422749f7f459abcf3de835201c77794/c1b63/docker-layers.png" /></p>
<p><br /></p>
<p>To keep layers small, it is best to group related commands together in a single line in the Dockerfile. For example, instead of installing several packages in separate RUN commands, it is better to install them all in a single RUN command. This will result in fewer layers and a smaller image size.</p>
<p><br /></p>
<p>It is also important to clean up any temporary files created during the build process, as these files can add unnecessary weight to the image. The <code>RUN</code> command should be followed by a <code>CLEANUP</code> command to remove any unwanted files and dependencies.</p>
<p><br /></p>
<p>Additionally, using the <code>--no-cache</code> flag when building an image can help to reduce the size of layers, as it prevents Docker from caching layers and forces it to rebuild each layer from scratch.</p>
<h3 id="use-multi-stage-builds">Use multi-stage builds</h3>
<p>Multi-stage builds are a way to optimize your Docker images and reduce their size. It allows you to use multiple FROM statements in your Dockerfile, each of which specifies a different base image.</p>
<p><br /></p>
<p>Here's an example of how you might use multi-stage builds to build a Python application using Flask:</p>
<pre><code class="language-dockerfile"># Use an official Python runtime as a parent image
FROM python:3.8-slim-buster AS base

# Set the working directory to /app
WORKDIR /app

# Copy the requirements file to the working directory
COPY requirements.txt .

# Install any needed packages specified in requirements.txt
RUN pip install --no-cache-dir --upgrade pip &amp;&amp; \
    pip install --no-cache-dir -r requirements.txt

# Use a smaller image as the final base image
FROM python:3.8-slim-buster

# Set the working directory to /app
WORKDIR /app

# Copy the requirements file and installed packages from the previous stage
COPY --from=base /usr/local/lib/python3.8/site-packages /usr/local/lib/python3.8/site-packages

# Copy the rest of the application code to the working directory
COPY . .

# Start the Flask application
CMD [&quot;python&quot;, &quot;app.py&quot;]
</code></pre>
<p>In this example, the Dockerfile uses two stages. The first stage starts with the official Python 3.8 slim-buster image, sets the working directory to <code>/app</code>, and copies the <code>requirements.txt</code> file to the working directory. It then installs the required packages specified in the <code>requirements.txt</code> file and saves them to the image.</p>
<p><br /></p>
<p>The second stage starts with the same <code>Python 3.8 slim-buster</code> image as the final base image. It sets the working directory to <code>/app</code>, copies the installed packages from the first stage to the image, copies the rest of the application code to the working directory, and starts the Flask application.</p>
<p><br /></p>
<p>Using multi-stage builds can significantly reduce the size of your Docker images because you only include the necessary files and dependencies in the final image. In this example, the final image only includes the installed Python packages and the application code, which makes it much smaller than if it included the entire Python runtime.</p>
<p><br /></p>
<p>Overall, using multi-stage builds is a best practice for optimizing your Docker images and reducing their size.</p>
<h3 id="use-caching-to-speed-up-builds">Use caching to speed up builds</h3>
<p>In Docker, every instruction in a Dockerfile creates a layer like we seen before. When a Dockerfile is built, Docker caches each layer, so that if the same instruction is used in a future build, Docker can use the cached layer instead of re-executing the instruction. This can greatly speed up the build process.</p>
<p><br /></p>
<p>One way to take advantage of caching is to order the instructions in the Dockerfile such that the ones that change frequently are at the end, while the ones that change less frequently are at the beginning. For example, you might start with a base image, then copy in your application code, and finally install any dependencies.</p>
<p><br /></p>
<p>It's also possible to explicitly tell Docker to use a cached layer with the --cache-from flag. This can be useful if you have multiple Dockerfiles that share some of the same layers. For example, if you have a base image that is used by multiple applications, you can build that image once and then use it as the cache for future builds of the applications.</p>
<p><br /></p>
<p>Here's an example of how to use caching to speed up a Docker build:</p>
<pre><code class="language-dockerfile"># Use an official Python runtime as a parent image
FROM python:3.9-slim-buster

# Set the working directory to /app
WORKDIR /app

# Copy the requirements file into the container
COPY requirements.txt .

# Install any needed packages specified in requirements.txt
RUN pip install --no-cache-dir -r requirements.txt

# Copy the rest of the application code into the container
COPY . .

# Expose port 80 for the web application
EXPOSE 80

# Start the web application
CMD [&quot;python&quot;, &quot;app.py&quot;]
</code></pre>
<p>In this example, the <code>COPY requirements.txt .</code> and <code>RUN pip install --no-cache-dir -r requirements.txt</code> instructions are near the beginning of the Dockerfile because they change less frequently than the application code. This means that Docker can cache those layers and reuse them in future builds, even if the application code has changed.</p>
<h3 id="clean-up-after-yourself">Clean up after yourself</h3>
<p>Cleaning up after yourself is an important best practice for Docker. This means removing any unused images, containers, volumes, and networks that are no longer needed. Not only does it save disk space, but it also ensures that the Docker environment is not cluttered with unnecessary artifacts that may cause conflicts or security issues.</p>
<p><br /></p>
<p>Here are some tips for cleaning up after yourself in Docker:</p>
<ol>
<li><strong>Remove unused containers</strong>: To remove unused containers, use the <code>docker container prune</code> command. This command removes all stopped containers. If you want to remove a specific container, use the <code>docker rm</code> command followed by the container ID.</li>
<li><strong>Remove unused images</strong>: To remove unused images, use the <code>docker image prune</code> command. This command removes all images that are not associated with any container. If you want to remove a specific image, use the <code>docker rmi</code> command followed by the image ID.</li>
<li><strong>Remove unused volumes</strong>: To remove unused volumes, use the <code>docker volume prune</code> command. This command removes all volumes that are not associated with any container. If you want to remove a specific volume, use the <code>docker volume rm</code> command followed by the volume name.</li>
<li><strong>Remove unused networks</strong>: To remove unused networks, use the <code>docker network prune</code> command. This command removes all networks that are not associated with any container. If you want to remove a specific network, use the <code>docker network rm</code> command followed by the network name.</li>
<li><strong>Use <code>--rm</code> option</strong>: When running containers, use the <code>--rm</code> option to automatically remove the container when it exits. This is especially useful for testing and development environments where you don't need to keep the container around.</li>
</ol>
<p>By following these best cleaning practices, you can keep your Docker environment clean and avoid cluttering it with unused artifacts.</p>
<h3 id="consider-security">Consider security</h3>
<p>Security is an important consideration when it comes to Docker containers. Here are some best practices to keep in mind:</p>
<ol>
<li><strong>Use the latest version of the base image</strong>: It is important to use the latest version of the base image, as this will ensure that any security vulnerabilities in the base image have been patched.</li>
<li><strong>Avoid using root user</strong>: Running a container as root can be risky, as it can potentially allow an attacker to gain access to the host system. Instead, use a non-root user.</li>
<li><strong>Limit container capabilities</strong>: By default, containers have access to all capabilities of the host system. It is important to limit the capabilities of the container to only what it needs.</li>
<li><strong>Use a minimal base image</strong>: Using a minimal base image, such as Alpine, reduces the attack surface of the container by reducing the number of packages installed.</li>
<li><strong>Keep containers up to date</strong>: It is important to keep containers up to date with security patches and updates.</li>
<li><strong>Scan images for vulnerabilities</strong>: Use a vulnerability scanner to scan images for known vulnerabilities. This will help to identify any potential security issues.</li>
<li><strong>Consider network security</strong>: Secure network access to containers by using network segmentation, firewalls, and VPNs. A common practice is to run containers inside your cloud provider's VPC. </li>
</ol>
<h4 id="quick-scan-a-container">Quick scan a container</h4>
<ol>
<li>
<p>First, install Trivy by following the installation instructions for your operating system from the official Trivy GitHub page: <a href="https://github.com/aquasecurity/trivy">https://github.com/aquasecurity/trivy</a></p>
</li>
<li>
<p>Then Pull a Docker image that you want to scan, for example, the official Python image:</p>
</li>
</ol>
<pre><code>docker pull python:3.9-slim
</code></pre>
<ol>
<li>Run Trivy against the image:</li>
</ol>
<pre><code>trivy image python:3.9-slim
</code></pre>
<p>This will scan the Python image and report any vulnerabilities found in the image's base image or any installed packages.</p>
<p><br /></p>
<p>You can also scan a Dockerfile directly using the --file option:</p>
<pre><code>trivy --file Dockerfile
</code></pre>
<p>This will scan the Dockerfile and report any vulnerabilities found in the base image or any installed packages.</p>
<p><br /></p>
<p>Note that scanning Docker images is just one part of a comprehensive security strategy for containerized applications. It's also important to ensure that your containers are configured securely, that you use strong authentication and authorization mechanisms, and that you regularly apply security updates and patches to your container images.</p>
<p><br /></p>
<p>By following these best practices, you can help to ensure that your Docker containers are secure and less vulnerable to attack.</p>
<h2 id="debugging-and-troubleshooting">Debugging and Troubleshooting</h2>
<ol>
<li><strong>Check container logs</strong>: Container logs can provide valuable information on what is happening inside the container. Use <code>docker logs &lt;container-id&gt;</code> to view container logs and troubleshoot issues.</li>
<li><strong>Use docker exec to troubleshoot running containers</strong>: <code>docker exec</code> allows you to run commands inside a running container, which can be useful for troubleshooting issues.</li>
<li><strong>Check container health</strong>: Use <code>docker ps</code> to check the status of running containers. If a container is not running, use <code>docker ps -a</code> to view all containers, including stopped ones.</li>
<li><strong>Check resource utilization</strong>: Docker containers can consume a lot of resources. Use <code>docker stats</code> to view resource utilization for running containers.</li>
<li><strong>Use the correct Docker command</strong>: Use the correct Docker command for the task at hand. For example, <code>docker stop</code> will gracefully stop a container, while <code>docker kill</code> will forcibly stop a container.</li>
<li><strong>Check networking</strong>: If your container is not communicating with other containers or services, check the networking configuration. Use docker network ls to view available networks and <code>docker network inspect</code> to view details of a specific network.</li>
<li><strong>Consider container security</strong>: Ensure that your container is running in a secure environment and follow security best practices for your application like we have seen before. </li>
</ol>
<p>By following best practices for Dockerfile design and container optimization and knowing how to troubleshoot common issues with Docker containers, you can ensure that your Docker containers are running smoothly and securely.</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.e5c33ebb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.51d95adb.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>